<!DOCTYPE html>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
</head>
<body>
<div class="container">
<h1>로그인</h1>
    <form action="/login" method="post" name="loginForm">
    <div class="form-group">
        <label th:for="id">아이디</label>
        <input type="text" name="id" class="form-control" placeholder="아이디를 입력해주세요">
    </div>
    <div class="form-group">
        <label th:for="pw">비밀번호</label>
        <input type="text" name="pw" class="form-control" placeholder="비밀번호를 입력해주세요">
    </div>
        <div th:if="${param.error}">
            <p th:text="${exception}" class="alert alert-danger"></p>
        </div>
        <button onclick="loginCustom_ajax()" class="btn btn-primary">Submit</button>
        <button type="button" class="btn btn-primary" onClick="location.href='/add'">회원 가입</button>
    </form>
    <script  src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script>
function loginCustom_ajax(){
var datas = objToJson($("form[name=loginForm]").serializeArray());

$.ajax({
type : 'POST',
url : 'http://localhost:8080/login',
data : JSON.stringify(datas),
dataType : 'json',  //위와 같이 dataType:json 일 경우 json 형태로 맞춰서 데이터를 받지 못해 오류 발생
contentType : "application/json",
error: function(xhr, status, error){
alert(error);
},
success : function(token){
console.log(token);
var expireDay = 24 * 60 * 60 * 1000; //1일
document.cookie = "X-AUTH-TOKEN=" + token + expireDay +"; path=/";

},
});
}
</script>

</div>

</body>
</html>